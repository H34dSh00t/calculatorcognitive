<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ö–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</title>

<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:Segoe UI, sans-serif;
  display:flex;
  justify-content:center;
  padding:20px;
}
.card{
  max-width:700px;
  width:100%;
  background:#111;
  border-radius:20px;
  padding:20px;
  box-shadow:0 0 30px rgba(0,255,255,.2);
}
h2,h3{
  text-align:center;
}
button{
  width:100%;
  margin:8px 0;
  padding:14px;
  border-radius:12px;
  border:none;
  background:#1a1a1a;
  color:#fff;
  cursor:pointer;
  transition:.2s;
}
button:hover{transform:scale(1.02)}
.selected{
  background:linear-gradient(270deg,#00f4ff,#0600ff);
  background-size:400% 400%;
  animation:glow 2s infinite;
}
@keyframes glow{
  0%{background-position:0%}
  50%{background-position:100%}
  100%{background-position:0%}
}
.panel{
  background:#0c0c0c;
  padding:15px;
  border-radius:15px;
  margin-top:15px;
}
input,textarea{
  width:100%;
  background:#000;
  color:#fff;
  border:1px solid #333;
  border-radius:10px;
  padding:10px;
}
label{font-size:.9em}
.small{font-size:.8em;color:#aaa}
</style>
</head>

<body>
<div class="card" id="app">
  <h2>–ö–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h2>
</div>

<script>
// ================== –¢–ï–°–¢ ==================
const questions = [
 {q:"–ö–∞–∫ —Ç—ã –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–µ—à—å —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å?", a:[
  ["Se","–ß–µ—Ä–µ–∑ –æ—â—É—â–µ–Ω–∏—è –∏ –¥–µ–π—Å—Ç–≤–∏—è —Å–µ–π—á–∞—Å"],
  ["Si","–ß–µ—Ä–µ–∑ –ø—Ä–æ—à–ª—ã–π –æ–ø—ã—Ç –∏ –ø–∞–º—è—Ç—å"]
 ]},
 {q:"–ö–∞–∫ —Ç—ã –≤–∏–¥–∏—à—å –∏–¥–µ–∏ –∏ –±—É–¥—É—â–µ–µ?", a:[
  ["Ni","–û–¥–∏–Ω —Å–º—ã—Å–ª –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ"],
  ["Ne","–ú–Ω–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏ –∏–¥–µ–π"]
 ]},
 {q:"–ö–∞–∫ —Ç—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ—à—å —Ü–µ–Ω–Ω–æ—Å—Ç—å?", a:[
  ["Fi","–ü–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —á—É–≤—Å—Ç–≤–∞–º"],
  ["Fe","–ü–æ —ç–º–æ—Ü–∏—è–º –¥—Ä—É–≥–∏—Ö"]
 ]},
 {q:"–ö–∞–∫ —Ç—ã –ø—Ä–æ–≤–µ—Ä—è–µ—à—å —Ä–µ—à–µ–Ω–∏–µ?", a:[
  ["Ti","–õ–æ–≥–∏–∫–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞"],
  ["Te","–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç"]
 ]}
];

let step=0;
let answers=[];
let score={Ni:0,Ne:0,Si:0,Se:0,Fi:0,Fe:0,Ti:0,Te:0};

// ================== –ü–ê–ú–Ø–¢–¨ ==================
let memory = JSON.parse(localStorage.getItem("memory")||"[]");

function remember(role,content){
  const on=document.getElementById("memToggle").checked;
  if(!on) return;
  memory.push({role,content});
  if(memory.length>6) memory.shift();
  localStorage.setItem("memory",JSON.stringify(memory));
}

function clearMemory(){
  memory=[];
  localStorage.removeItem("memory");
  alert("–ü–∞–º—è—Ç—å –æ—á–∏—â–µ–Ω–∞");
}

// ================== –†–ï–ù–î–ï–† ==================
function render(){
  const app=document.getElementById("app");
  app.innerHTML="<h2>–ö–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h2>";

  if(step>=questions.length){
    let r="<div class='panel'><h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>";
    for(let k in score) r+=`${k}: ${score[k]}<br>`;
    r+=`<button onclick="reset()">–ü—Ä–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ</button></div>`;
    app.innerHTML+=r;
    renderChat();
    return;
  }

  const q=questions[step];
  app.innerHTML+=`<p><b>${q.q}</b></p>`;

  q.a.forEach(o=>{
    const b=document.createElement("button");
    b.textContent=o[1];
    if(answers[step]==o[0]) b.classList.add("selected");
    b.onclick=()=>{
      if(answers[step]) score[answers[step]]--;
      answers[step]=o[0];
      score[o[0]]++;
      step++;
      render();
    };
    app.appendChild(b);
  });
}

function reset(){
  step=0;
  answers=[];
  for(let k in score) score[k]=0;
  render();
}

// ================== –ß–ê–¢ ==================
function renderChat(){
  const app=document.getElementById("app");
  app.innerHTML+=`
  <div class="panel">
    <h3>–ò–ò-—Å–æ–±–µ—Å–µ–¥–Ω–∏–∫</h3>

    <label>
      <input type="checkbox" id="memToggle" checked>
      –í–∫–ª—é—á–∏—Ç—å –ø–∞–º—è—Ç—å
    </label>

    <textarea id="userText" placeholder="–°–ø—Ä–æ—Å–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å..."></textarea>
    <button onclick="askAI()">–°–ø—Ä–æ—Å–∏—Ç—å</button>
    <button onclick="clearMemory()">–û—á–∏—Å—Ç–∏—Ç—å –ø–∞–º—è—Ç—å</button>

    <div id="aiAnswer" class="small"></div>
  </div>`;
}

function askAI(){
  const t=document.getElementById("userText").value.trim();
  if(!t) return;

  remember("user",t);

  // üîå –ó–ê–ì–õ–£–®–ö–ê (—Å—é–¥–∞ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è OpenAI API)
  const answer="ü§îüß© –Ø –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é —Ç–≤–æ–π –∑–∞–ø—Ä–æ—Å –ª–æ–≥–∏—á–µ—Å–∫–∏ –∏ –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ.";
  remember("assistant",answer);

  document.getElementById("aiAnswer").innerText=answer;
  document.getElementById("userText").value="";
}

// ================== START ==================
render();
</script>
</body>
</html>
